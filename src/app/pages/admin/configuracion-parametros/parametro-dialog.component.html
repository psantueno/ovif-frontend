<h2 mat-dialog-title class="dialog-title">
  <mat-icon class="dialog-title-icon">{{ icon }}</mat-icon>
  {{ title }}
</h2>

<mat-dialog-content [formGroup]="form" class="dialog-content">
  <mat-form-field class="full-width" appearance="fill">
    <mat-label>Nombre</mat-label>
    <input matInput formControlName="nombre" />
    <mat-error *ngIf="form.get('nombre')?.hasError('required') && form.get('nombre')?.touched">
      El nombre es obligatorio
    </mat-error>
    <mat-error *ngIf="form.get('nombre')?.hasError('minlength') && form.get('nombre')?.touched">
      Debe tener al menos 3 caracteres
    </mat-error>
  </mat-form-field>

  <mat-form-field class="full-width" appearance="fill">
    <mat-label>Valor</mat-label>
    <textarea matInput formControlName="valor" rows="4"></textarea>
    <mat-error *ngIf="form.get('valor')?.hasError('required') && form.get('valor')?.touched">
      El valor es obligatorio
    </mat-error>
  </mat-form-field>

  <mat-form-field class="full-width" appearance="fill">
    <mat-label>Descripción</mat-label>
    <textarea matInput formControlName="descripcion" rows="3"></textarea>
  </mat-form-field>

  <mat-slide-toggle formControlName="estado">Activo</mat-slide-toggle>

  <div class="metadata" *ngIf="isViewMode && data.parametro">
    <div class="metadata-row">
      <span class="label">Creado por</span>
      <span class="value">{{ creadorDisplay }}</span>
    </div>
    <div class="metadata-row">
      <span class="label">Fecha de creación</span>
      <span class="value">{{ data.parametro.created_at ? (data.parametro.created_at | date:'dd/MM/yyyy HH:mm') : 'Sin datos' }}</span>
    </div>
    <div class="metadata-row">
      <span class="label">Modificado por</span>
      <span class="value">{{ actualizadoPorDisplay }}</span>
    </div>
    <div class="metadata-row">
      <span class="label">Última modificación</span>
      <span class="value">{{ data.parametro.updated_at ? (data.parametro.updated_at | date:'dd/MM/yyyy HH:mm') : 'Sin datos' }}</span>
    </div>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end" class="dialog-actions">
  <button mat-stroked-button mat-dialog-close [disabled]="enviando">
    {{ isViewMode ? 'Cerrar' : 'Cancelar' }}
  </button>
  <button mat-raised-button color="primary" type="button" (click)="guardar()" [disabled]="enviando" *ngIf="!isViewMode">
    <mat-icon *ngIf="!enviando">save</mat-icon>
    <mat-icon class="girando" *ngIf="enviando">hourglass_top</mat-icon>
    {{ data.mode === 'edit' ? 'Actualizar' : 'Guardar' }}
  </button>
</mat-dialog-actions>
