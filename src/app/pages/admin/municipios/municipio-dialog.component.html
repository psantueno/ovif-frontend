<h2 mat-dialog-title class="dialog-title">
  <mat-icon class="dialog-title-icon">
    {{ data?.municipio_id ? 'edit_location_alt' : 'add_location_alt' }}
  </mat-icon>
  {{ data?.municipio_id ? 'Editar municipio' : 'Nuevo municipio' }}
</h2>

<mat-dialog-content [formGroup]="form" class="dialog-content">
  <div class="alert-info" *ngIf="!municipioModificable">
    <mat-icon class="alert-icon">
      warning
    </mat-icon>
    <div class="alert-content">
      <p class="alert-title">Registro no editable</p>
      <p class="alert-message">
        Este registro no puede ser modificado porque se encuentra asociado a otros datos o ya fue procesado.
      </p>
    </div>
  </div>
  <mat-form-field class="full-width" appearance="fill">
    <mat-label>Nombre del municipio</mat-label>
    <input matInput formControlName="municipio_nombre" />
    <mat-error *ngIf="form.get('municipio_nombre')?.hasError('required') && form.get('municipio_nombre')?.touched">
      El nombre es obligatorio
    </mat-error>
    <mat-error *ngIf="form.get('municipio_nombre')?.hasError('minlength') && form.get('municipio_nombre')?.touched">
      Debe tener al menos 3 caracteres
    </mat-error>
  </mat-form-field>

  <div class="campos-grid">
    <mat-form-field appearance="fill">
      <mat-label>Valor SPAR (entero)</mat-label>
      <input matInput type="number" step="1" formControlName="municipio_spar" />
      <mat-error *ngIf="form.get('municipio_spar')?.hasError('required') && form.get('municipio_spar')?.touched">
        El valor es obligatorio
      </mat-error>
      <mat-error *ngIf="form.get('municipio_spar')?.hasError('pattern') && form.get('municipio_spar')?.touched">
        Debe ser un entero
      </mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Valor UBGE (entero)</mat-label>
      <input matInput type="number" step="1" formControlName="municipio_ubge" />
      <mat-error *ngIf="form.get('municipio_ubge')?.hasError('required') && form.get('municipio_ubge')?.touched">
        El valor es obligatorio
      </mat-error>
      <mat-error *ngIf="form.get('municipio_ubge')?.hasError('pattern') && form.get('municipio_ubge')?.touched">
        Debe ser un entero
      </mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Población estimada</mat-label>
      <input matInput type="number" formControlName="municipio_poblacion" min="0" />
      <mat-error *ngIf="form.get('municipio_poblacion')?.hasError('required') && form.get('municipio_poblacion')?.touched">
        La población es obligatoria
      </mat-error>
      <mat-error *ngIf="form.get('municipio_poblacion')?.hasError('min') && form.get('municipio_poblacion')?.touched">
        Debe ser un número mayor o igual a cero
      </mat-error>
    </mat-form-field>
  </div>

  <div class="toggle-wrapper">
    <mat-slide-toggle formControlName="municipio_subir_archivos">Permite subir archivos</mat-slide-toggle>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end" class="dialog-actions">
  <button mat-stroked-button class="btn-cancelar" mat-dialog-close [disabled]="enviando">
    Cancelar
  </button>
  <button
    mat-raised-button
    color="primary"
    class="btn-guardar"
    type="button"
    (click)="guardar()"
    [disabled]="enviando || !municipioModificable"
  >
    <mat-icon *ngIf="!enviando">save</mat-icon>
    <mat-icon class="girando" *ngIf="enviando">hourglass_top</mat-icon>
    {{ data?.municipio_id ? 'Actualizar' : 'Guardar' }}
  </button>
</mat-dialog-actions>

<app-loading-overlay [display]="enviando"></app-loading-overlay>
